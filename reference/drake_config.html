<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create the internal runtime parameter list
used internally in <code><a href='make.html'>make()</a></code>. — drake_config • drake</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>



<!-- Bootstrap -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>

<!-- ropensci -->
<link href="../ropensci.css" rel="stylesheet">

<meta property="og:title" content="Create the internal runtime parameter list
used internally in <code><a href='make.html'>make()</a></code>. — drake_config" />

<meta property="og:description" content="drake_config() collects and sanitizes the multitude of
parameters and settings that make() needs to do its job:
the plan, packages,
the environment of functions and initial data objects,
parallel computing instructions,
verbosity level, etc." />

<meta property="og:image" content="https://ropensci.github.io/drake/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-462421-8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-462421-8');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://ropensci.org"><img src="../hexlogo.png" id="hexlogo" alt="rOpenSci" /></a>
        <a class="navbar-brand" href="../index.html"><i>drake <small>v7.4.0.9000</small></i></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="https://ropenscilabs.github.io/drake-manual">Full manual</a>
</li>
<li>
  <a href="https://ropenscilabs.github.io/drake-manual/faq.html">FAQ</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        <li>
  <a href="https://github.com/ropensci/drake">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create the internal runtime parameter list
used internally in <code><a href='make.html'>make()</a></code>.</h1>
    <small class="dont-index">Source: <a href='https://github.com/ropensci/drake/blob/master/R/preprocess-config.R'><code>R/preprocess-config.R</code></a></small>
    <div class="hidden name"><code>drake_config.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>drake_config()</code> collects and sanitizes the multitude of
parameters and settings that <code><a href='make.html'>make()</a></code> needs to do its job:
the plan, packages,
the environment of functions and initial data objects,
parallel computing instructions,
verbosity level, etc.</p>
    
    </div>

    <pre class="usage"><span class='fu'>drake_config</span>(<span class='no'>plan</span>, <span class='kw'>targets</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>envir</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame</a></span>(),
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>hook</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>cache</span> <span class='kw'>=</span> <span class='kw pkg'>drake</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/drake/man/drake_cache.html'>drake_cache</a></span>(<span class='kw'>verbose</span> <span class='kw'>=</span>
  <span class='no'>verbose</span>, <span class='kw'>console_log_file</span> <span class='kw'>=</span> <span class='no'>console_log_file</span>), <span class='kw'>fetch_cache</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>parallelism</span> <span class='kw'>=</span> <span class='st'>"loop"</span>, <span class='kw'>jobs</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>jobs_preprocess</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>packages</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/zpackages.html'>.packages</a></span>()), <span class='kw'>lib_loc</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>prework</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span>(<span class='fl'>0</span>), <span class='kw'>prepend</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>command</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>args</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>recipe_command</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>timeout</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>cpu</span> <span class='kw'>=</span> <span class='fl'>Inf</span>,
  <span class='kw'>elapsed</span> <span class='kw'>=</span> <span class='fl'>Inf</span>, <span class='kw'>retries</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>force</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>log_progress</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>graph</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>trigger</span> <span class='kw'>=</span> <span class='kw pkg'>drake</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/drake/man/trigger.html'>trigger</a></span>(), <span class='kw'>skip_targets</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>skip_imports</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>skip_safety_checks</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>lazy_load</span> <span class='kw'>=</span> <span class='st'>"eager"</span>, <span class='kw'>session_info</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>cache_log_file</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>caching</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"master"</span>, <span class='st'>"worker"</span>), <span class='kw'>keep_going</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>session</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>pruning_strategy</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>makefile_path</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>console_log_file</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>ensure_workers</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>garbage_collection</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>template</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(), <span class='kw'>sleep</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>i</span>)
  <span class='fl'>0.01</span>, <span class='kw'>hasty_build</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>memory_strategy</span> <span class='kw'>=</span> <span class='st'>"speed"</span>, <span class='kw'>layout</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>lock_envir</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>history</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>recover</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>recoverable</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>plan</th>
      <td><p>Workflow plan data frame.
A workflow plan data frame is a data frame
with a <code>target</code> column and a <code>command</code> column.
(See the details in the <code><a href='drake_plan.html'>drake_plan()</a></code> help file
for descriptions of the optional columns.)
Targets are the objects that drake generates,
and commands are the pieces of R code that produce them.
You can create and track custom files along the way
(see <code><a href='file_in.html'>file_in()</a></code>, <code><a href='file_out.html'>file_out()</a></code>, and <code><a href='knitr_in.html'>knitr_in()</a></code>).
Use the function <code><a href='drake_plan.html'>drake_plan()</a></code> to generate workflow plan
data frames.</p></td>
    </tr>
    <tr>
      <th>targets</th>
      <td><p>Character vector, names of targets to build.
Dependencies are built too. Together, the <code>plan</code> and
<code>targets</code> comprise the workflow network
(i.e. the <code>graph</code> argument).
Changing either will change the network.</p></td>
    </tr>
    <tr>
      <th>envir</th>
      <td><p>Environment to use. Defaults to the current
workspace, so you should not need to worry about this
most of the time. A deep copy of <code>envir</code> is made,
so you don't need to worry about your workspace being modified
by <code>make</code>. The deep copy inherits from the global environment.
Wherever necessary, objects and functions are imported
from <code>envir</code> and the global environment and
then reproducibly tracked as dependencies.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Integer, control printing to the console/terminal.</p><ul>
<li><p><code>0</code>: print nothing.</p></li>
<li><p><code>1</code>: print targets, retries, and failures.</p></li>
<li><p><code>2</code>: also show a spinner when preprocessing tasks are underway.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>hook</th>
      <td><p>Deprecated.</p></td>
    </tr>
    <tr>
      <th>cache</th>
      <td><p>drake cache as created by <code><a href='new_cache.html'>new_cache()</a></code>.
See also <code><a href='drake_cache.html'>drake_cache()</a></code>.</p></td>
    </tr>
    <tr>
      <th>fetch_cache</th>
      <td><p>Deprecated.</p></td>
    </tr>
    <tr>
      <th>parallelism</th>
      <td><p>Character scalar, type of parallelism to use.
For detailed explanations, see the
<a href='https://ropenscilabs.github.io/drake-manual/hpc.html'>high-performance computing chapter</a>
of the user manual.</p>
<p>You could also supply your own scheduler function
if you want to experiment or aggressively optimize.
The function should take a single <code>config</code> argument
(produced by <code>drake_config()</code>). Existing examples
from <code>drake</code>'s internals are the <code>backend_*()</code> functions:</p><ul>
<li><p><code>backend_loop()</code></p></li>
<li><p><code>backend_clustermq()</code></p></li>
<li><p><code>backend_future()</code>
However, this functionality is really a back door
and should not be used for production purposes unless you really
know what you are doing and you are willing to suffer setbacks
whenever <code>drake</code>'s unexported core functions are updated.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>jobs</th>
      <td><p>Maximum number of parallel workers for processing the targets.
You can experiment with <code><a href='predict_runtime.html'>predict_runtime()</a></code>
to help decide on an appropriate number of jobs.
For details, visit
<a href='https://ropenscilabs.github.io/drake-manual/time.html'>https://ropenscilabs.github.io/drake-manual/time.html</a>.</p></td>
    </tr>
    <tr>
      <th>jobs_preprocess</th>
      <td><p>Number of parallel jobs for processing the imports
and doing other preprocessing tasks.</p></td>
    </tr>
    <tr>
      <th>packages</th>
      <td><p>Character vector packages to load, in the order
they should be loaded. Defaults to <code><a href='https://rdrr.io/r/base/rev.html'>rev(.packages())</a></code>, so you
should not usually need to set this manually. Just call
<code><a href='https://rdrr.io/r/base/library.html'>library()</a></code> to load your packages before <code><a href='make.html'>make()</a></code>.
However, sometimes packages need to be strictly forced to load
in a certain order, especially if <code>parallelism</code> is
<code>"Makefile"</code>. To do this, do not use <code><a href='https://rdrr.io/r/base/library.html'>library()</a></code>
or <code><a href='https://rdrr.io/r/base/library.html'>require()</a></code> or <code><a href='https://rdrr.io/r/base/ns-load.html'>loadNamespace()</a></code> or
<code><a href='https://rdrr.io/r/base/ns-load.html'>attachNamespace()</a></code> to load any libraries beforehand.
Just list your packages in the <code>packages</code> argument in the order
you want them to be loaded.</p></td>
    </tr>
    <tr>
      <th>lib_loc</th>
      <td><p>Character vector, optional.
Same as in <code><a href='https://rdrr.io/r/base/library.html'>library()</a></code> or <code><a href='https://rdrr.io/r/base/library.html'>require()</a></code>.
Applies to the <code>packages</code> argument (see above).</p></td>
    </tr>
    <tr>
      <th>prework</th>
      <td><p>Expression (language object), list of expressions,
or character vector.
Code to run right before targets build.
Called only once if <code>parallelism</code> is <code>"loop"</code>
and once per target otherwise.
This code can be used to set global options, etc.</p></td>
    </tr>
    <tr>
      <th>prepend</th>
      <td><p>Deprecated.</p></td>
    </tr>
    <tr>
      <th>command</th>
      <td><p>Deprecated.</p></td>
    </tr>
    <tr>
      <th>args</th>
      <td><p>Deprecated.</p></td>
    </tr>
    <tr>
      <th>recipe_command</th>
      <td><p>Deprecated.</p></td>
    </tr>
    <tr>
      <th>timeout</th>
      <td><p><code>deprecated</code>. Use <code>elapsed</code> and <code>cpu</code> instead.</p></td>
    </tr>
    <tr>
      <th>cpu</th>
      <td><p>Same as the <code>cpu</code> argument of <code><a href='https://rdrr.io/r/base/setTimeLimit.html'>setTimeLimit()</a></code>.
Seconds of cpu time before a target times out.
Assign target-level cpu timeout times with an optional <code>cpu</code>
column in <code>plan</code>.</p></td>
    </tr>
    <tr>
      <th>elapsed</th>
      <td><p>Same as the <code>elapsed</code> argument of <code><a href='https://rdrr.io/r/base/setTimeLimit.html'>setTimeLimit()</a></code>.
Seconds of elapsed time before a target times out.
Assign target-level elapsed timeout times with an optional <code>elapsed</code>
column in <code>plan</code>.</p></td>
    </tr>
    <tr>
      <th>retries</th>
      <td><p>Number of retries to execute if the target fails.
Assign target-level retries with an optional <code>retries</code>
column in <code>plan</code>.</p></td>
    </tr>
    <tr>
      <th>force</th>
      <td><p>Logical. If <code>FALSE</code> (default) then <code>drake</code>
imposes checks if the cache was created with an old
and incompatible version of drake.
If there is an incompatibility, <code><a href='make.html'>make()</a></code> stops to
give you an opportunity to
downgrade <code>drake</code> to a compatible version
rather than rerun all your targets from scratch.</p></td>
    </tr>
    <tr>
      <th>log_progress</th>
      <td><p>Logical, whether to log the progress
of individual targets as they are being built. Progress logging
creates extra files in the cache (usually the <code>.drake/</code> folder)
and slows down <code><a href='make.html'>make()</a></code> a little.
If you need to reduce or limit the number of files in the cache,
call <code><a href='make.html'>make(log_progress = FALSE, recover = FALSE)</a></code>.</p></td>
    </tr>
    <tr>
      <th>graph</th>
      <td><p>An <code>igraph</code> object from the previous <code><a href='make.html'>make()</a></code>.
Supplying a pre-built graph could save time.</p></td>
    </tr>
    <tr>
      <th>trigger</th>
      <td><p>Name of the trigger to apply to all targets.
Ignored if <code>plan</code> has a <code>trigger</code> column.
See <code><a href='trigger.html'>trigger()</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>skip_targets</th>
      <td><p>Logical, whether to skip building the targets
in <code>plan</code> and just import objects and files.</p></td>
    </tr>
    <tr>
      <th>skip_imports</th>
      <td><p>Logical, whether to totally neglect to
process the imports and jump straight to the targets. This can be useful
if your imports are massive and you just want to test your project,
but it is bad practice for reproducible data analysis.
This argument is overridden if you supply your own <code>graph</code> argument.</p></td>
    </tr>
    <tr>
      <th>skip_safety_checks</th>
      <td><p>Logical, whether to skip the safety checks
on your workflow. Use at your own peril.</p></td>
    </tr>
    <tr>
      <th>lazy_load</th>
      <td><p>Either a character vector or a logical. Choices:</p><ul>
<li><p><code>"eager"</code>: no lazy loading. The target is loaded right away
with <code><a href='https://rdrr.io/r/base/assign.html'>assign()</a></code>.</p></li>
<li><p><code>"promise"</code>: lazy loading with <code><a href='https://rdrr.io/r/base/delayedAssign.html'>delayedAssign()</a></code></p></li>
<li><p><code>"bind"</code>: lazy loading with active bindings:
<code><a href='https://rdrr.io/pkg/bindr/man/create_env.html'>bindr::populate_env()</a></code>.</p></li>
<li><p><code>TRUE</code>: same as <code>"promise"</code>.</p></li>
<li><p><code>FALSE</code>: same as <code>"eager"</code>.</p></li>
</ul>

<p><code>lazy_load</code> should not be <code>"promise"</code>
for <code>"parLapply"</code> parallelism combined with <code>jobs</code> greater than 1.
For local multi-session parallelism and lazy loading, try
<code><a href='https://rdrr.io/r/base/library.html'>library(future); future::plan(multisession)</a></code> and then
<code><a href='make.html'>make(..., parallelism = "future_lapply", lazy_load = "bind")</a></code>.</p>
<p>If <code>lazy_load</code> is <code>"eager"</code>,
drake prunes the execution environment before each target/stage,
removing all superfluous targets
and then loading any dependencies it will need for building.
In other words, drake prepares the environment in advance
and tries to be memory efficient.
If <code>lazy_load</code> is <code>"bind"</code> or <code>"promise"</code>, drake assigns
promises to load any dependencies at the last minute.
Lazy loading may be more memory efficient in some use cases, but
it may duplicate the loading of dependencies, costing time.</p></td>
    </tr>
    <tr>
      <th>session_info</th>
      <td><p>Logical, whether to save the <code><a href='https://rdrr.io/r/utils/sessionInfo.html'>sessionInfo()</a></code>
to the cache. This behavior is recommended for serious <code><a href='make.html'>make()</a></code>s
for the sake of reproducibility. This argument only exists to
speed up tests. Apparently, <code><a href='https://rdrr.io/r/utils/sessionInfo.html'>sessionInfo()</a></code> is a bottleneck
for small <code><a href='make.html'>make()</a></code>s.</p></td>
    </tr>
    <tr>
      <th>cache_log_file</th>
      <td><p>Name of the CSV cache log file to write.
If <code>TRUE</code>, the default file name is used (<code>drake_cache.CSV</code>).
If <code>NULL</code>, no file is written.
If activated, this option writes a flat text file
to represent the state of the cache
(fingerprints of all the targets and imports).
If you put the log file under version control, your commit history
will give you an easy representation of how your results change
over time as the rest of your project changes. Hopefully,
this is a step in the right direction for data reproducibility.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>Integer, the root pseudo-random number generator
seed to use for your project.
In <code><a href='make.html'>make()</a></code>, <code>drake</code> generates a unique
local seed for each target using the global seed
and the target name. That way, different pseudo-random numbers
are generated for different targets, and this pseudo-randomness
is reproducible.</p>
<p>To ensure reproducibility across different R sessions,
<code><a href='https://rdrr.io/r/base/Random.html'>set.seed()</a></code> and <code>.Random.seed</code> are ignored and have no affect on
<code>drake</code> workflows. Conversely, <code><a href='make.html'>make()</a></code> does not usually
change <code>.Random.seed</code>,
even when pseudo-random numbers are generated.
The exception to this last point is
<code><a href='make.html'>make(parallelism = "clustermq")</a></code>
because the <code>clustermq</code> package needs to generate random numbers
to set up ports and sockets for ZeroMQ.</p>
<p>On the first call to <code><a href='make.html'>make()</a></code> or <code>drake_config()</code>, <code>drake</code>
uses the random number generator seed from the <code>seed</code> argument.
Here, if the <code>seed</code> is <code>NULL</code> (default), <code>drake</code> uses a <code>seed</code> of <code>0</code>.
On subsequent <code><a href='make.html'>make()</a></code>s for existing projects, the project's
cached seed will be used in order to ensure reproducibility.
Thus, the <code>seed</code> argument must either be <code>NULL</code> or the same
seed from the project's cache (usually the <code>.drake/</code> folder).
To reset the random number generator seed for a project,
use <code><a href='clean.html'>clean(destroy = TRUE)</a></code>.</p></td>
    </tr>
    <tr>
      <th>caching</th>
      <td><p>Character string, either <code>"master"</code> or <code>"worker"</code>.</p><ul>
<li><p><code>"master"</code>: Targets are built by remote workers and sent back to
the master process. Then, the master process saves them to the
cache (<code>config$cache</code>, usually a file system <code>storr</code>).
Appropriate if remote workers do not have access to the file system
of the calling R session. Targets are cached one at a time,
which may be slow in some situations.</p></li>
<li><p><code>"worker"</code>: Remote workers not only build the targets, but also
save them to the cache. Here, caching happens in parallel.
However, remote workers need to have access to the file system
of the calling R session. Transferring target data across
a network can be slow.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>keep_going</th>
      <td><p>Logical, whether to still keep running <code><a href='make.html'>make()</a></code>
if targets fail.</p></td>
    </tr>
    <tr>
      <th>session</th>
      <td><p>Deprecated. Has no effect now.</p></td>
    </tr>
    <tr>
      <th>pruning_strategy</th>
      <td><p>Deprecated. See <code>memory_strategy</code>.</p></td>
    </tr>
    <tr>
      <th>makefile_path</th>
      <td><p>Deprecated.</p></td>
    </tr>
    <tr>
      <th>console_log_file</th>
      <td><p>Optional character scalar of a file name or
connection object (such as <code><a href='https://rdrr.io/r/base/showConnections.html'>stdout()</a></code>) to dump maximally verbose
log information for <code><a href='make.html'>make()</a></code> and other functions (all functions that
accept a <code>config</code> argument, plus <code>drake_config()</code>).
If you choose to use a text file as the console log,
it will persist over multiple function calls
until you delete it manually.
Fields in each row the log file, from left to right:
- The node name (short host name) of the
computer (from <code>Sys.info()["nodename"]</code>).
- The process ID (from <code><a href='https://rdrr.io/r/base/Sys.getpid.html'>Sys.getpid()</a></code>).
- A timestamp with the date and time (in microseconds).
- A brief description of what <code>drake</code> was doing.<code> The fields are separated by pipe symbols (</code>"|"`).</p></td>
    </tr>
    <tr>
      <th>ensure_workers</th>
      <td><p>Deprecated.</p></td>
    </tr>
    <tr>
      <th>garbage_collection</th>
      <td><p>Logical, whether to call <code><a href='https://rdrr.io/r/base/gc.html'>gc()</a></code> each time
a target is built during <code><a href='make.html'>make()</a></code>.</p></td>
    </tr>
    <tr>
      <th>template</th>
      <td><p>A named list of values to fill in the <code>{{ ... }}</code>
placeholders in template files (e.g. from <code><a href='drake_hpc_template_file.html'>drake_hpc_template_file()</a></code>).
Same as the <code>template</code> argument of <code><a href='https://rdrr.io/pkg/clustermq/man/Q.html'>clustermq::Q()</a></code> and
<code><a href='https://rdrr.io/pkg/clustermq/man/workers.html'>clustermq::workers</a></code>.
Enabled for <code>clustermq</code> only (<code><a href='make.html'>make(parallelism = "clustermq")</a></code>),
not <code>future</code> or <code>batchtools</code> so far.
For more information, see the <code>clustermq</code> package:
<a href='https://github.com/mschubert/clustermq'>https://github.com/mschubert/clustermq</a>.
Some template placeholders such as <code>{{ job_name }}</code> and <code>{{ n_jobs }}</code>
cannot be set this way.</p></td>
    </tr>
    <tr>
      <th>sleep</th>
      <td><p>Optional function on a single numeric argument <code>i</code>.
Default: <code>function(i) 0.01</code>.</p>
<p>To conserve memory, <code>drake</code> assigns a brand new closure to
<code>sleep</code>, so your custom function should not depend on in-memory data
except from loaded packages.</p>
<p>For parallel processing, <code>drake</code> uses
a central master process to check what the parallel
workers are doing, and for the affected high-performance
computing workflows, wait for data to arrive over a network.
In between loop iterations, the master process sleeps to avoid throttling.
The <code>sleep</code> argument to <code><a href='make.html'>make()</a></code> and <code>drake_config()</code>
allows you to customize how much time the master process spends
sleeping.</p>
<p>The <code>sleep</code> argument is a function that takes an argument
<code>i</code> and returns a numeric scalar, the number of seconds to
supply to <code><a href='https://rdrr.io/r/base/Sys.sleep.html'>Sys.sleep()</a></code> after iteration <code>i</code> of checking.
(Here, <code>i</code> starts at 1.)
If the checking loop does something other than sleeping
on iteration <code>i</code>, then <code>i</code> is reset back to 1.</p>
<p>To sleep for the same amount of time between checks,
you might supply something like <code>function(i) 0.01</code>.
But to avoid consuming too many resources during heavier
and longer workflows, you might use an exponential
back-off: say,
<code>function(i) { 0.1 + 120 * pexp(i - 1, rate = 0.01) }</code>.</p></td>
    </tr>
    <tr>
      <th>hasty_build</th>
      <td><p>A user-defined function.
In "hasty mode" (<code><a href='make.html'>make(parallelism = "hasty")</a></code>)
this is the function that evaluates a target's command
and returns the resulting value. The <code>hasty_build</code> argument
has no effect if <code>parallelism</code> is any value other than "hasty".</p>
<p>The function you pass to <code>hasty_build</code> must have arguments <code>target</code>
and <code>config</code>. Here, <code>target</code> is a character scalar naming the
target being built, and <code>config</code> is a configuration list of
runtime parameters generated by <code>drake_config()</code>.</p></td>
    </tr>
    <tr>
      <th>memory_strategy</th>
      <td><p>Character scalar, name of the
strategy <code>drake</code> uses to load/unload a target's dependencies in memory.
You can give each target its own memory strategy,
(e.g. <code><a href='drake_plan.html'>drake_plan(x = 1, y = target(f(x), memory_strategy = "lookahead"))</a></code>)
to override the global memory strategy. Choices:</p><ul>
<li><p><code>"speed"</code>: Once a target is newly built or loaded in memory,
just keep it there.
This choice maximizes speed and hogs memory.</p></li>
<li><p><code>"autoclean"</code>: Just before building each new target,
unload everything from memory except the target's direct dependencies.
After a target is built, discard it from memory.
(Set <code>garbage_collection = TRUE</code> to make sure it is really gone.)
This option conserves memory, but it sacrifices speed because
each new target needs to reload
any previously unloaded targets from storage.</p></li>
<li><p><code>"preclean"</code>: Just before building each new target,
unload everything from memory except the target's direct dependencies.
After a target is built, keep it in memory until <code>drake</code> determines
they can be unloaded.
This option conserves memory, but it sacrifices speed because
each new target needs to reload
any previously unloaded targets from storage.</p></li>
<li><p><code>"lookahead"</code>: Just before building each new target,
search the dependency graph to find targets that will not be
needed for the rest of the current <code><a href='make.html'>make()</a></code> session.
After a target is built, keep it in memory until the next
memory management stage.
In this mode, targets are only in memory if they need to be loaded,
and we avoid superfluous reads from the cache.
However, searching the graph takes time,
and it could even double the computational overhead for large projects.</p></li>
<li><p><code>"unload"</code>: Just before building each new target,
unload all targets from memory.
After a target is built, <strong>do not</strong> keep it in memory.
This mode aggressively optimizes for both memory and speed,
but in commands and triggers,
you have to manually load any dependencies you need using <code><a href='readd.html'>readd()</a></code>.</p></li>
<li><p><code>"none"</code>: Do not manage memory at all.
Do not load or unload anything before building targets.
After a target is built, <strong>do not</strong> keep it in memory.
This mode aggressively optimizes for both memory and speed,
but in commands and triggers,
you have to manually load any dependencies you need using <code><a href='readd.html'>readd()</a></code>.</p></li>
</ul>

<p>For even more direct
control over which targets <code>drake</code> keeps in memory, see the
help file examples of <code><a href='drake_envir.html'>drake_envir()</a></code>.
Also see the <code>garbage_collection</code> argument of <code><a href='make.html'>make()</a></code> and
<code>drake_config()</code>.</p></td>
    </tr>
    <tr>
      <th>layout</th>
      <td><p><code>config$layout</code>, where <code>config</code> is the return value
from a prior call to <code>drake_config()</code>. If your plan or environment
have changed since the last <code><a href='make.html'>make()</a></code>, do not supply a <code>layout</code> argument.
Otherwise, supplying one could save time.</p></td>
    </tr>
    <tr>
      <th>lock_envir</th>
      <td><p>Logical, whether to lock <code>config$envir</code> during <code><a href='make.html'>make()</a></code>.
If <code>TRUE</code>, <code><a href='make.html'>make()</a></code> quits in error whenever a command in your
<code>drake</code> plan (or <code>prework</code>) tries to add, remove, or modify
non-hidden variables in your environment/workspace/R session.
This is extremely important for ensuring the purity of your functions
and the reproducibility/credibility/trust you can place in your project.
<code>lock_envir</code> will be set to a default of <code>TRUE</code> in <code>drake</code> version
7.0.0 and higher.</p></td>
    </tr>
    <tr>
      <th>history</th>
      <td><p>Logical, whether to record the build history
of your targets. You can also supply a
<a href='https://github.com/wlandau/txtq'>txtq</a>, which is
how <code>drake</code> records history.
Must be <code>TRUE</code> for <code><a href='drake_history.html'>drake_history()</a></code> to work later.</p></td>
    </tr>
    <tr>
      <th>recover</th>
      <td><p>Logical, whether to activate automated data recovery.
The default is <code>FALSE</code> because</p><ol>
<li><p>Automated data recovery is still experimental.</p></li>
<li><p>It has reproducibility issues.
Targets recovered from the distant past may have been generated
with earlier versions of R and earlier package environments
that no longer exist.</p></li>
</ol>

<p>How it works: if <code>recover</code> is <code>TRUE</code>,
<code>drake</code> tries to salvage old target values from the cache
instead of running commands from the plan.
A target is recoverable if</p><ol>
<li><p>There is an old value somewhere in the cache that
shares the command, dependencies, etc.
of the target about to be built.</p></li>
<li><p>The old value was generated with <code><a href='make.html'>make(recoverable = TRUE)</a></code>.</p></li>
</ol>

<p>If both conditions are met, <code>drake</code> will</p><ol>
<li><p>Assign the most recently-generated admissible data to the target, and</p></li>
<li><p>skip the target's command.</p></li>
</ol>

<p>Functions <code><a href='recoverable.html'>recoverable()</a></code> and <code><a href='r_make.html'>r_recoverable()</a></code> show the most upstream
outdated targets that will be recovered in this way in the next
<code><a href='make.html'>make()</a></code> or <code><a href='r_make.html'>r_make()</a></code>.</p></td>
    </tr>
    <tr>
      <th>recoverable</th>
      <td><p>Logical, whether to make target values recoverable
with <code><a href='make.html'>make(recover = TRUE)</a></code>.
This requires writing extra files to the cache,
and it prevents old metadata from being removed with garbage collection
(<code><a href='clean.html'>clean(garbage_collection = TRUE)</a></code>, <code><a href='https://rdrr.io/r/base/gc.html'>gc()</a></code> in <code>storr</code>s).
If you need to limit the cache size or the number of files in the cache,
consider <code><a href='make.html'>make(recoverable = FALSE, progress = FALSE)</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The master internal configuration list of a project.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Once you create a list with <code>drake_config()</code>,
do not modify it by hand.</p>
<p>Utility functions such as <code><a href='outdated.html'>outdated()</a></code>,
<code><a href='vis_drake_graph.html'>vis_drake_graph()</a></code>, and <code><a href='predict_runtime.html'>predict_runtime()</a></code> require output from
<code>drake_config()</code> for the <code>config</code> argument.
If you supply a <code>drake_config()</code> object to the <code>config</code>
argument of <code><a href='make.html'>make()</a></code>, then <code>drake</code> will ignore all the other arguments
because it already has everything it needs in <code>config</code>.</p>
    
    <h2 class="hasAnchor" id="recovery"><a class="anchor" href="#recovery"></a>Recovery</h2>

    

<p><code><a href='make.html'>make(recover = TRUE, recoverable = TRUE)</a></code>
powers automated data recovery.
The default of <code>recover</code> is <code>FALSE</code> because</p><ol>
<li><p>Automated data recovery is still experimental.</p></li>
<li><p>It has reproducibility issues.
Targets recovered from the distant past may have been generated
with earlier versions of R and earlier package environments
that no longer exist.</p></li>
</ol>

<p>How it works: if <code>recover</code> is <code>TRUE</code>,
<code>drake</code> tries to salvage old target values from the cache
instead of running commands from the plan.
A target is recoverable if</p><ol>
<li><p>There is an old value somewhere in the cache that
shares the command, dependencies, etc.
of the target about to be built.</p></li>
<li><p>The old value was generated with <code><a href='make.html'>make(recoverable = TRUE)</a></code>.</p></li>
</ol>

<p>If both conditions are met, <code>drake</code> will</p><ol>
<li><p>Assign the most recently-generated admissible data to the target, and</p></li>
<li><p>skip the target's command.</p></li>
</ol>

    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='make.html'>make()</a></code>, <code><a href='drake_plan.html'>drake_plan()</a></code>, <code><a href='vis_drake_graph.html'>vis_drake_graph()</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'><a href='isolate_example.html'>isolate_example</a></span>(<span class='st'>"Quarantine side effects."</span>, {
<span class='fu'><a href='load_mtcars_example.html'>load_mtcars_example</a></span>() <span class='co'># Get the code with drake_example("mtcars").</span>
<span class='co'># Construct the master internal configuration list.</span>
<span class='no'>config</span> <span class='kw'>&lt;-</span> <span class='fu'>drake_config</span>(<span class='no'>my_plan</span>)
<span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span>(<span class='st'>"visNetwork"</span>)) {
  <span class='fu'><a href='vis_drake_graph.html'>vis_drake_graph</a></span>(<span class='no'>config</span>) <span class='co'># See the dependency graph.</span>
  <span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span>(<span class='st'>"networkD3"</span>)) {
    <span class='fu'><a href='sankey_drake_graph.html'>sankey_drake_graph</a></span>(<span class='no'>config</span>) <span class='co'># See the dependency graph.</span>
  }
}
<span class='co'># These functions are faster than otherwise</span>
<span class='co'># because they use the configuration list.</span>
<span class='fu'><a href='outdated.html'>outdated</a></span>(<span class='no'>config</span>) <span class='co'># Which targets are out of date?</span>
<span class='fu'><a href='missed.html'>missed</a></span>(<span class='no'>config</span>) <span class='co'># Which imports are missing?</span>
})
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#recovery">Recovery</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div style="margin-top:-9px">
  <p>drake is a part of <img src='https://github.com/ropensci/logos/raw/master/icon_lettering_color.png' height=40 alt = 'rOpenSci'>. Learn more at <a href="https://ropensci.org">ropensci.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by William Michael Landau.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a> & <a href="https://docs.ropensci.org/rotemplate/">rotemplate</a>.
  </p>
</div>

      </footer>
   </div>

  


  </body>
</html>


